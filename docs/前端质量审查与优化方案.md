# Web ç•Œé¢è§„èŒƒå®¡æŸ¥ä¸ä¼˜åŒ–æ–¹æ¡ˆ

> åŸºäº [Web Interface Guidelines](https://github.com/vercel-labs/web-interface-guidelines) å’Œ [Vercel React Best Practices](https://github.com/vercel-labs/react-19-performance) å¯¹ `any_concept_web` é¡¹ç›®çš„å…¨é¢å®¡æŸ¥ã€‚
>
> å®¡æŸ¥æ—¥æœŸï¼š2026-02-22

---

## ç›®å½•

- [ç¬¬ä¸€éƒ¨åˆ†ï¼šWeb ç•Œé¢è§„èŒƒ](#ç¬¬ä¸€éƒ¨åˆ†web-ç•Œé¢è§„èŒƒ)
- [ç¬¬äºŒéƒ¨åˆ†ï¼šReact æ€§èƒ½ä¼˜åŒ–](#ç¬¬äºŒéƒ¨åˆ†react-æ€§èƒ½ä¼˜åŒ–)
- [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)

---

## é—®é¢˜æ€»è§ˆ

### ç•Œé¢è§„èŒƒ

| ç±»åˆ« | æ•°é‡ | ä¼˜å…ˆçº§ |
|------|------|--------|
| è¯­ä¹‰åŒ– HTML / æ— éšœç¢ | ~20 | P0 |
| ç„¦ç‚¹çŠ¶æ€ | ~8 | P0 |
| åŠ¨ç”» / reduced-motion | ~8 | P1 |
| åæ¨¡å¼ | ~3 | P1 |
| å›½é™…åŒ– / ä¸»é¢˜ | ~3 | P2 |

### React æ€§èƒ½

| ä¼˜å…ˆçº§ | ç±»åˆ« | å‘ç°æ•°é‡ |
|--------|------|----------|
| CRITICAL | è¯·æ±‚ç€‘å¸ƒæµ | 2 |
| CRITICAL | Bundle ä½“ç§¯ | 3 |
| HIGH | æœåŠ¡ç«¯æ€§èƒ½ | 2 |
| MEDIUM-HIGH | å®¢æˆ·ç«¯æ•°æ®è·å– | 2 |
| MEDIUM | é‡æ¸²æŸ“ä¼˜åŒ– | 4 |
| MEDIUM | æ¸²æŸ“æ€§èƒ½ | 3 |
| LOW-MEDIUM | JavaScript æ€§èƒ½ | 2 |

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šWeb ç•Œé¢è§„èŒƒ

## P0ï¼šå¿…é¡»ä¿®å¤

### 1. NavButton ä½¿ç”¨ `<div onClick>` ä»£æ›¿ `<button>`

**æ–‡ä»¶ï¼š** `src/components/NavButton.tsx:24-27`

**é—®é¢˜ï¼š** å¯¼èˆªåˆ‡æ¢æŒ‰é’®ä½¿ç”¨ `<div onClick>` å®ç°ï¼Œç¼ºå°‘é”®ç›˜æ”¯æŒã€ç„¦ç‚¹ç®¡ç†å’Œæ— éšœç¢æ ‡ç­¾ã€‚å±å¹•é˜…è¯»å™¨ç”¨æˆ·å’Œé”®ç›˜ç”¨æˆ·æ— æ³•æ“ä½œæ­¤æŒ‰é’®ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
<div
  className="fixed bottom-4 right-4 md:bottom-12 md:right-12 z-50 hover:cursor-pointer p-4"
  onClick={toggleNav}
>
```

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<button
  className="fixed bottom-4 right-4 md:bottom-12 md:right-12 z-50 cursor-pointer p-4
             focus-visible:ring-2 focus-visible:ring-black/20 focus-visible:ring-offset-2 rounded-full"
  onClick={toggleNav}
  aria-label={isOpen ? 'å…³é—­å¯¼èˆªèœå•' : 'æ‰“å¼€å¯¼èˆªèœå•'}
  aria-expanded={isOpen}
>
```

**åŒæ—¶ä¿®æ”¹å›¾æ ‡ alt æ–‡æœ¬ï¼š**

- `alt="nav-logo"` â†’ `alt=""` ï¼ˆå›¾æ ‡å·²ç”± `aria-label` æè¿°ï¼Œè®¾ä¸ºè£…é¥°æ€§å›¾ç‰‡ï¼‰

---

### 2. äº¤äº’æ–‡æœ¬å…ƒç´ ç¼ºå°‘é”®ç›˜æ”¯æŒ

**æ–‡ä»¶ï¼š** `src/components/TypewriterText.tsx:167-180`

**é—®é¢˜ï¼š** å¯ç‚¹å‡»çš„ `<motion.span>` å…ƒç´ ç¼ºå°‘ `role="button"`ã€`tabIndex`ã€`onKeyDown` å’Œ `aria-label`ï¼Œé”®ç›˜ç”¨æˆ·å®Œå…¨æ— æ³•æ“ä½œã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
<motion.span
  className={getStyleClasses()}
  onClick={isInteractive && !isDisabled && onClick ? onClick : undefined}
  onMouseEnter={...}
  onMouseLeave={...}
>
```

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<motion.span
  className={getStyleClasses()}
  role={isInteractive ? 'button' : undefined}
  tabIndex={isInteractive && !isDisabled ? 0 : undefined}
  aria-disabled={isDisabled || undefined}
  onClick={isInteractive && !isDisabled && onClick ? onClick : undefined}
  onKeyDown={isInteractive && !isDisabled && onClick ? (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      onClick();
    }
  } : undefined}
  onMouseEnter={...}
  onMouseLeave={...}
>
```

**å…³è”æ–‡ä»¶ï¼š** `src/components/InteractiveText.tsx:374` â€” `<Word>` ç»„ä»¶è°ƒç”¨å¤„åŒæ ·å—ç›Šäºæ­¤ä¿®æ”¹ã€‚

---

### 3. `outline-none` æ— æ›¿ä»£ç„¦ç‚¹æ ·å¼

**æ–‡ä»¶ï¼š** `src/components/WorkItem.tsx:119, 128`

**é—®é¢˜ï¼š** `<Link>` ä¸Šä½¿ç”¨äº† `outline-none`ï¼Œç§»é™¤äº†é»˜è®¤ç„¦ç‚¹æŒ‡ç¤ºå™¨ä½†æœªæä¾› `focus-visible` æ›¿ä»£æ–¹æ¡ˆã€‚é”®ç›˜ç”¨æˆ·æ— æ³•çœ‹åˆ°å½“å‰ç„¦ç‚¹ä½ç½®ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
<Link href={link} className="block outline-none" ...>
<Link href={`/craft/${slug}`} className="block outline-none">
```

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<Link href={link} className="block outline-none focus-visible:ring-2 focus-visible:ring-black/20 focus-visible:ring-offset-2 rounded-xl" ...>
<Link href={`/craft/${slug}`} className="block outline-none focus-visible:ring-2 focus-visible:ring-black/20 focus-visible:ring-offset-2 rounded-xl">
```

---

### 4. è¯­è¨€åˆ‡æ¢æŒ‰é’®ç¼ºå°‘ `aria-label`

**æ–‡ä»¶ï¼š** `src/components/LanguageSwitcher/index.tsx:25`

**é—®é¢˜ï¼š** æŒ‰é’®å†…éƒ¨æ˜¯è§†è§‰åŒ–çš„æ»‘å—ï¼Œå±å¹•é˜…è¯»å™¨æ— æ³•ç†è§£å…¶ç”¨é€”ã€‚

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<button
  onClick={toggleLanguage}
  aria-label={locale === 'zh' ? 'Switch to English' : 'åˆ‡æ¢ä¸ºä¸­æ–‡'}
  className="... focus-visible:ring-2 focus-visible:ring-black/20 focus-visible:ring-offset-2"
>
```

---

### 5. Craft å’Œ Projects åˆ—è¡¨é¡µç¼ºå°‘ `<h1>`

**æ–‡ä»¶ï¼š**

- `src/app/craft/page.tsx:33`
- `src/app/projects/page.tsx:31`

**é—®é¢˜ï¼š** ä¸¤ä¸ªåˆ—è¡¨é¡µé¢éƒ½æ²¡æœ‰ `<h1>` æ ‡é¢˜ï¼Œå½±å“é¡µé¢æ ‡é¢˜å±‚çº§å’Œå±å¹•é˜…è¯»å™¨å¯¼èˆªã€‚

**å»ºè®®ä¿®æ”¹ï¼ˆcraft/page.tsx ç¤ºä¾‹ï¼‰ï¼š**

```tsx
<main className="bg-white text-black/87 min-h-screen p-2 pb-36">
  <h1 className="sr-only">{t('nav.craft')}</h1>
  ...
</main>
```

---

### 6. ç„¦ç‚¹æ ·å¼ç¼ºå¤±æ±‡æ€»

ä»¥ä¸‹å…ƒç´ å‡ç¼ºå°‘ `focus-visible` æ ·å¼ï¼Œéœ€é€ä¸€è¡¥å……ï¼š

| æ–‡ä»¶ | è¡Œå· | å…ƒç´  |
|------|------|------|
| `NavButton.tsx` | 24 | å¯¼èˆªåˆ‡æ¢æŒ‰é’® |
| `NavButton.tsx` | 149 | NavItem `<Link>` |
| `LanguageSwitcher/index.tsx` | 25 | è¯­è¨€åˆ‡æ¢æŒ‰é’® |
| `WorkItem.tsx` | 119, 128 | ä½œå“å¡ç‰‡é“¾æ¥ |
| `ProjectItem.tsx` | 191 | é¡¹ç›®åˆ—è¡¨è¡Œé“¾æ¥ |
| `projects/[slug]/page.tsx` | 306 | ä¸Š/ä¸‹ä¸€ä¸ªé¡¹ç›®å¯¼èˆª |
| `craft/[slug]/page.tsx` | 114 | ä¸Š/ä¸‹ä¸€ä¸ªä½œå“å¯¼èˆª |

**ç»Ÿä¸€æ–¹æ¡ˆï¼š** åœ¨ `globals.css` ä¸­æ·»åŠ å…¨å±€ç„¦ç‚¹æ ·å¼åŸºç¡€ç±»ï¼Œæˆ–åœ¨ Tailwind ä¸­ç»Ÿä¸€ä½¿ç”¨ï¼š

```css
focus-visible:ring-2 focus-visible:ring-black/20 focus-visible:ring-offset-2
```

---

## P1ï¼šå»ºè®®ä¿®å¤

### 7. å…¨å±€ç¼ºå°‘ `prefers-reduced-motion` æ”¯æŒ

**å½±å“èŒƒå›´ï¼š** æ‰“å­—æœºæ•ˆæœã€è®¡æ•°å™¨é—ªçƒã€çº¿æ¡åŠ¨ç”»ã€é¡µé¢è¿‡æ¸¡ç­‰æ‰€æœ‰åŠ¨ç”»ã€‚

**æ–‡ä»¶æ¸…å•ï¼š**

- `src/app/globals.css:139` â€” `.counter-blinker--idle` åŠ¨ç”»
- `src/app/globals.css:162` â€” `.word-clickable` è¿‡æ¸¡
- `src/components/TypewriterText.tsx` â€” æ‰“å­—æœºåŠ¨ç”»
- `src/components/InteractiveText.tsx` â€” å±•å¼€åŠ¨ç”»
- `src/components/NavButton.tsx` â€” å¯¼èˆªè¦†ç›–å±‚åŠ¨ç”»
- `src/app/projects/ProjectItem.tsx:222` â€” `<style jsx>` çº¿æ¡åŠ¨ç”»
- `src/components/WorkItem.tsx:105` â€” `hover:translate-y-[-1px]`
- `src/app/craft/[slug]/MediaRenderer.tsx:22` â€” `<video autoPlay>`

**å»ºè®®ä¿®æ”¹ï¼ˆglobals.css æ·»åŠ å…¨å±€è§„åˆ™ï¼‰ï¼š**

```css
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

**TypewriterText ç»„ä»¶é¢å¤–å¤„ç†ï¼š**

```tsx
// æ£€æµ‹ç”¨æˆ·æ˜¯å¦åå¥½å‡å¼±åŠ¨ç”»
const prefersReducedMotion =
  typeof window !== 'undefined' &&
  window.matchMedia('(prefers-reduced-motion: reduce)').matches;

// å¦‚æœåå¥½å‡å¼±åŠ¨ç”»ï¼Œç›´æ¥æ˜¾ç¤ºå®Œæ•´æ–‡æœ¬
if (prefersReducedMotion) {
  setDisplayText(text);
  setIsComplete(true);
  return;
}
```

**è§†é¢‘è‡ªåŠ¨æ’­æ”¾å¤„ç†ï¼ˆcraft MediaRendererï¼‰ï¼š**

```tsx
<video
  src={src}
  autoPlay={!prefersReducedMotion}
  muted
  loop={!prefersReducedMotion}
  playsInline
/>
```

---

### 8. è£…é¥°æ€§ SVG ç¼ºå°‘ `aria-hidden="true"`

**æ–‡ä»¶æ¸…å•ï¼š**

| æ–‡ä»¶ | è¡Œå· | æè¿° |
|------|------|------|
| `InteractiveText.tsx` | 410 | å¤–éƒ¨é“¾æ¥æŒ‡ç¤ºå™¨ SVG |
| `WorkItem.tsx` | 110 | ç®­å¤´ SVG |
| `projects/[slug]/page.tsx` | 201, 224 | å¤–éƒ¨é“¾æ¥å›¾æ ‡ |
| `projects/[slug]/page.tsx` | 317, 349 | ä¸Š/ä¸‹ä¸€é¡¹å¯¼èˆªç®­å¤´ |
| `craft/[slug]/page.tsx` | 119, 157 | ä¸Š/ä¸‹ä¸€é¡¹å¯¼èˆªç®­å¤´ |

**ä¿®æ”¹æ–¹å¼ï¼š** åœ¨æ‰€æœ‰è£…é¥°æ€§ `<svg>` ä¸Šæ·»åŠ  `aria-hidden="true"`ï¼š

```tsx
<svg aria-hidden="true" ...>
```

---

### 9. å¯¼èˆªè¦†ç›–å±‚ç¼ºå°‘ `overscroll-behavior`

**æ–‡ä»¶ï¼š** `src/components/NavButton.tsx:75`

**é—®é¢˜ï¼š** å…¨å±å¯¼èˆªè¦†ç›–å±‚æ‰“å¼€æ—¶ï¼ŒèƒŒæ™¯å†…å®¹å¯èƒ½è¢«æ»šåŠ¨ã€‚

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<motion.div
  className="fixed inset-0 bg-white z-40"
  style={{ overscrollBehavior: 'contain' }}
  ...
>
```

---

### 10. `<video>` å…ƒç´ ç¼ºå°‘å­—å¹•è½¨é“

**æ–‡ä»¶ï¼š**

- `src/components/WorkItem.tsx:73-77, 80-86`
- `src/app/projects/[slug]/MediaRenderer.tsx:22-30`
- `src/app/craft/[slug]/MediaRenderer.tsx:22-32`

**å»ºè®®ï¼š** ä¸ºè§†é¢‘æ·»åŠ ç©ºå­—å¹•è½¨é“ï¼ˆè¡¨æ˜å·²è€ƒè™‘æ— éšœç¢ï¼‰ï¼š

```tsx
<video ...>
  <track kind="captions" />
</video>
```

---

### 11. InteractiveText ä¸­çš„ç›´æ¥ DOM æ“ä½œ

**æ–‡ä»¶ï¼š** `src/components/InteractiveText.tsx:284`

**é—®é¢˜ï¼š** ä½¿ç”¨ `document.querySelector('.counter-blinker')` ç›´æ¥æ“ä½œ DOMï¼Œä¸ç¬¦åˆ React å£°æ˜å¼èŒƒå¼ï¼Œä¸”åœ¨ SSR ç¯å¢ƒä¸‹å¯èƒ½å‡ºé”™ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
const blinker = document.querySelector('.counter-blinker');
if (blinker) {
  blinker.classList.add('counter-blinker--ping');
  ...
}
```

**å»ºè®®ä¿®æ”¹ï¼š** ä½¿ç”¨ `useRef` æ›¿ä»£ï¼š

```tsx
const blinkerRef = useRef<HTMLSpanElement>(null);

// åœ¨ useEffect ä¸­
if (blinkerRef.current) {
  blinkerRef.current.classList.add('counter-blinker--ping');
  ...
}

// åœ¨ JSX ä¸­
<span ref={blinkerRef} className={`counter-blinker ...`} />
```

---

## P2ï¼šæ”¹è¿›å»ºè®®

### 12. å¸ƒå±€å±‚ `<html>` ä¼˜åŒ–

**æ–‡ä»¶ï¼š** `src/app/layout.tsx`

**é—®é¢˜ï¼š**

- `lang="zh-CN"` ç¡¬ç¼–ç ï¼Œä½†åº”ç”¨æ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢
- ç¼ºå°‘ `<meta name="theme-color">`
- ç¼ºå°‘è·³è½¬åˆ°ä¸»å†…å®¹çš„ skip link

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="zh-CN" className={`${jetBrainsMono.variable}`}>
      <head>
        <meta name="theme-color" content="#ffffff" />
      </head>
      <body className="font-sans">
        <a
          href="#main-content"
          className="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2
                     focus:z-[100] focus:px-4 focus:py-2 focus:bg-white focus:text-black
                     focus:rounded-md focus:shadow-lg"
        >
          è·³è½¬åˆ°ä¸»è¦å†…å®¹
        </a>
        <Providers>
          {children}
        </Providers>
      </body>
    </html>
  )
}
```

> **æ³¨ï¼š** `lang` å±æ€§çš„åŠ¨æ€åˆ‡æ¢å·²åœ¨ `useLanguage` ä¸­é€šè¿‡ `useEffect` æ“ä½œ `document.documentElement.lang` å®ç°ã€‚

---

### 13. é¢åŒ…å±‘å¯¼èˆªç¼ºå°‘è¯­ä¹‰åŒ–æ ‡è®°

**æ–‡ä»¶ï¼š**

- `src/app/projects/[slug]/page.tsx:128`
- `src/app/craft/[slug]/page.tsx:80`

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<nav aria-label="é¢åŒ…å±‘å¯¼èˆª">
  <div className="flex items-center space-x-2 text-xs md:text-sm text-black/54 leading-none">
    <Link href="/">é¦–é¡µ</Link>
    <span aria-hidden="true">/</span>
    ...
  </div>
</nav>
```

---

### 14. åŠ è½½çŠ¶æ€ç¼ºå°‘æ— éšœç¢æç¤º

**æ–‡ä»¶ï¼š**

- `src/app/projects/page.tsx:37`
- `src/app/craft/page.tsx:39`
- `src/app/projects/[slug]/page.tsx:112`
- `src/app/craft/[slug]/page.tsx:68`

**å½“å‰ä»£ç ï¼š**

```tsx
<div className="min-h-[60vh]"></div>
```

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
<div className="min-h-[60vh]" role="status" aria-label="åŠ è½½ä¸­">
  <span className="sr-only">åŠ è½½ä¸­â€¦</span>
</div>
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šReact æ€§èƒ½ä¼˜åŒ–

## CRITICALï¼šè¯·æ±‚ç€‘å¸ƒæµ

### 15. è¯¦æƒ…é¡µæ•°æ®è¯·æ±‚å­˜åœ¨ä¸²è¡Œç€‘å¸ƒ `async-parallel`

**æ–‡ä»¶ï¼š**

- `src/app/projects/[slug]/page.tsx:66-99`
- `src/app/craft/[slug]/page.tsx:22-58`

**é—®é¢˜ï¼š** `getProjectBySlug(slug)` å’Œ `getAllProjects()` æ˜¯ä¸¤ä¸ªç‹¬ç«‹è¯·æ±‚ï¼Œä½†ä»£ç ä¸­å…ˆ await ç¬¬ä¸€ä¸ªå®Œæˆåæ‰å‘èµ·ç¬¬äºŒä¸ªï¼Œå½¢æˆè¯·æ±‚ç€‘å¸ƒã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
// projects/[slug]/page.tsx
const data = await projectsModule.getProjectBySlug(slug);
// ... å¤„ç† data
const allProjects = await projectsModule.getAllProjects();
```

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
const [data, allProjects] = await Promise.all([
  projectsModule.getProjectBySlug(slug),
  projectsModule.getAllProjects(),
]);

if (!data) {
  notFound();
}

const currentIndex = allProjects.findIndex(
  (p: { slug: string }) => p.slug === slug
);
setPrevProject(currentIndex > 0 ? allProjects[currentIndex - 1] : null);
setNextProject(
  currentIndex < allProjects.length - 1 ? allProjects[currentIndex + 1] : null
);
setProjectData(data);
setLoading(false);
```

**å½±å“ï¼š** è¯¦æƒ…é¡µåŠ è½½æ—¶é—´å‡åŠï¼ˆä¸¤ä¸ªè¯·æ±‚å¹¶è¡Œè€Œéä¸²è¡Œï¼‰ã€‚

---

### 16. åˆ—è¡¨é¡µæ•°æ®è·å–åœ¨å®¢æˆ·ç«¯å½¢æˆç€‘å¸ƒ `async-suspense-boundaries`

**æ–‡ä»¶ï¼š**

- `src/app/projects/page.tsx:17-28`
- `src/app/craft/page.tsx:19-30`

**é—®é¢˜ï¼š** é¡µé¢å…ˆæ¸²æŸ“ç©ºç™½ â†’ useEffect è§¦å‘ â†’ è·å–æ•°æ® â†’ å†æ¬¡æ¸²æŸ“ã€‚æ•´ä¸ªæµç¨‹æ˜¯ï¼šHTML ä¸‹è½½ â†’ JS ä¸‹è½½ â†’ React æ°´åˆ â†’ useEffect â†’ æ•°æ®è¯·æ±‚ â†’ æ¸²æŸ“å†…å®¹ï¼Œå½¢æˆå¤šå±‚ç€‘å¸ƒã€‚

**æ ¹æœ¬åŸå› ï¼š** æ‰€æœ‰é¡µé¢éƒ½æ ‡è®°ä¸º `'use client'`ï¼Œæ”¾å¼ƒäº† Next.js çš„æœåŠ¡ç«¯æ¸²æŸ“èƒ½åŠ›ï¼ˆè§ #21ï¼‰ã€‚

---

## CRITICALï¼šBundle ä½“ç§¯

### 17. NavButton åº”åŠ¨æ€åŠ è½½ `bundle-dynamic-imports`

**æ–‡ä»¶ï¼š** æ‰€æœ‰é¡µé¢ä¸­çš„ `<NavButton />`

- `src/app/page.tsx:21`
- `src/app/craft/page.tsx:63`
- `src/app/projects/page.tsx:56`
- ä»¥åŠæ‰€æœ‰è¯¦æƒ…é¡µ

**é—®é¢˜ï¼š** NavButton åŒ…å« framer-motion çš„ `AnimatePresence`ã€`motion`ã€`cubicBezier`ï¼Œä»¥åŠ `LanguageSwitcher`ã€‚è¿™äº›ä»£ç åœ¨é¡µé¢åˆå§‹æ¸²æŸ“æ—¶ä¸éœ€è¦ï¼ˆæŒ‰é’®é»˜è®¤å…³é—­çŠ¶æ€ï¼‰ï¼Œä½†è¢«æ‰“åŒ…åˆ°äº†é¦–å± JS ä¸­ã€‚

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
import dynamic from 'next/dynamic';

const NavButton = dynamic(() => import('@/components/NavButton'), {
  ssr: false,
});
```

**é¢„ä¼°æ”¶ç›Šï¼š** é¦–å± JS å‡å°‘ ~30-50KBï¼ˆframer-motion çš„ AnimatePresence + motion æ¨¡å—ï¼‰ã€‚

---

### 18. framer-motion å…¨é‡å¼•å…¥ `bundle-barrel-imports`

**æ–‡ä»¶ï¼š**

- `src/components/NavButton.tsx:5`
- `src/components/InteractiveText.tsx:4`
- `src/components/TypewriterText.tsx:4`
- `src/components/LanguageSwitcher/index.tsx:4`

**é—®é¢˜ï¼š** ä» `framer-motion` çš„ barrel export å¯¼å…¥ï¼Œå¯èƒ½å¯¼å…¥ä¸å¿…è¦çš„æ¨¡å—ã€‚

**å»ºè®®éªŒè¯æ–¹å¼ï¼š** ä½¿ç”¨ `@next/bundle-analyzer` æ£€æŸ¥å®é™… bundle å¤§å°ï¼š

```bash
npm install @next/bundle-analyzer
```

```ts
// next.config.ts
const withBundleAnalyzer = require('@next/bundle-analyzer')({
  enabled: process.env.ANALYZE === 'true',
});
module.exports = withBundleAnalyzer(nextConfig);
```

è¿è¡Œ `ANALYZE=true npm run build` æŸ¥çœ‹ framer-motion åœ¨ bundle ä¸­çš„å®é™…å æ¯”ã€‚

---

### 19. ä¸­è‹±æ–‡æ•°æ®åŒæ—¶æ‰“å…¥ Bundle `bundle-conditional`

**æ–‡ä»¶ï¼š** `src/data/localizedData.ts:1-7`

**é—®é¢˜ï¼š** ä¸­è‹±æ–‡çš„ introtextã€craftsã€projects æ•°æ®å…¨éƒ¨é™æ€å¯¼å…¥ï¼Œå³ä½¿ç”¨æˆ·åªä½¿ç”¨ä¸€ç§è¯­è¨€ï¼Œä¸¤ä»½æ•°æ®éƒ½ä¼šè¢«æ‰“åŒ…ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
import introDataZh from './introtext.json';
import introDataEn from './introtext_en.json';
import * as craftsZh from './crafts';
import * as craftsEn from './crafts_en';
import * as projectsZh from './projects';
import * as projectsEn from './projects_en';
```

**å»ºè®®ä¿®æ”¹ï¼š** ä½¿ç”¨åŠ¨æ€å¯¼å…¥æŒ‰éœ€åŠ è½½ï¼š

```tsx
export const getLocalizedData = async (locale: Locale, key: string) => {
  switch (key) {
    case 'introtext':
      return locale === 'zh'
        ? (await import('./introtext.json')).default
        : (await import('./introtext_en.json')).default;
    case 'crafts':
      return locale === 'zh'
        ? await import('./crafts')
        : await import('./crafts_en');
    case 'projects':
      return locale === 'zh'
        ? await import('./projects')
        : await import('./projects_en');
    default:
      throw new Error(`Unknown data key: ${key}`);
  }
};
```

> **æ³¨æ„ï¼š** æ­¤ä¿®æ”¹éœ€è¦åŒæ­¥æ›´æ–°æ‰€æœ‰è°ƒç”¨å¤„ä»¥ await ç»“æœã€‚

---

## HIGHï¼šæœåŠ¡ç«¯æ€§èƒ½

### 20. è¯­è¨€æ£€æµ‹å¯¼è‡´åŒé‡æ¸²æŸ“

**æ–‡ä»¶ï¼š** `src/hooks/useSafeLocaleStorage.ts`

**é—®é¢˜ï¼š** è¯­è¨€æ£€æµ‹æµç¨‹ä¸ºï¼š

1. æœåŠ¡ç«¯æ¸²æŸ“ â†’ ä½¿ç”¨é»˜è®¤è¯­è¨€ `'zh'` â†’ ç”Ÿæˆ HTML
2. å®¢æˆ·ç«¯æ°´åˆ â†’ `isClient` ä¸º `false` â†’ æ¸²æŸ“ç©ºç™½
3. useEffect è§¦å‘ â†’ `isClient` å˜ä¸º `true` â†’ è¯»å– localStorage â†’ é‡æ–°æ¸²æŸ“

è¿™å¯¼è‡´é¡µé¢**é—ªçƒ**ï¼ˆå…ˆç©ºç™½ï¼Œå†æ˜¾ç¤ºå†…å®¹ï¼‰ï¼Œä¸”å¼ºåˆ¶æ‰€æœ‰æ¶ˆè´¹ `isClient` çš„ç»„ä»¶éƒ½ç»å†è‡³å°‘ä¸¤æ¬¡æ¸²æŸ“ã€‚

**å»ºè®®æ”¹è¿›æ–¹å‘ï¼š**

- ä½¿ç”¨ cookie å­˜å‚¨è¯­è¨€åå¥½ï¼ˆæœåŠ¡ç«¯å¯è¯»å–ï¼Œé¿å…æ°´åˆä¸åŒ¹é…ï¼‰
- æˆ–ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ ¹æ® `Accept-Language` å’Œ cookie åœ¨æœåŠ¡ç«¯ç¡®å®šè¯­è¨€
- å°† `isClient` æ£€æŸ¥ä¸‹æ²‰åˆ°çœŸæ­£éœ€è¦çš„ç»„ä»¶ï¼Œä¸è¦åœ¨æ¯ä¸ªé¡µé¢éƒ½é˜»æ–­æ¸²æŸ“

---

### 21. æ‰€æœ‰é¡µé¢å‡ä¸ºå®¢æˆ·ç«¯ç»„ä»¶ `server-serialization`

**æ–‡ä»¶ï¼š** æ‰€æœ‰é¡µé¢ç»„ä»¶

**é—®é¢˜ï¼š** é¡¹ç›®ä¸­æ¯ä¸ªé¡µé¢éƒ½æ ‡è®°äº† `'use client'`ï¼Œå®Œå…¨æ”¾å¼ƒäº† Next.js App Router çš„ React Server Components èƒ½åŠ›ã€‚è¿™æ„å‘³ç€ï¼š

- æ‰€æœ‰ç»„ä»¶ JS éƒ½å‘é€åˆ°å®¢æˆ·ç«¯
- æ²¡æœ‰æœåŠ¡ç«¯æ•°æ®é¢„å–
- é¦–å±æ¸²æŸ“ä¸ºç©ºç™½æˆ–éª¨æ¶
- SEO å†…å®¹ä¸ºç©º

**å½“å‰æ¶æ„ï¼š**

```
ç”¨æˆ·è¯·æ±‚ â†’ ç©ºç™½ HTML â†’ ä¸‹è½½ JS â†’ æ°´åˆ â†’ useEffect â†’ æ•°æ®è¯·æ±‚ â†’ æ¸²æŸ“
```

**ç†æƒ³æ¶æ„ï¼š**

```
ç”¨æˆ·è¯·æ±‚ â†’ æœåŠ¡ç«¯è·å–æ•°æ® â†’ è¿”å›å®Œæ•´ HTMLï¼ˆStreamingï¼‰ â†’ æ°´åˆäº¤äº’éƒ¨åˆ†
```

**å»ºè®®ï¼š** å°†é¡µé¢æ‹†åˆ†ä¸ºæœåŠ¡ç«¯/å®¢æˆ·ç«¯ä¸¤å±‚ï¼š

```
page.tsx          (Server Component) â€” æ•°æ®è·å–ã€SEO metadata
â””â”€â”€ PageClient.tsx (Client Component) â€” äº¤äº’é€»è¾‘ã€åŠ¨ç”»
```

**ç¤ºä¾‹ï¼ˆprojects/page.tsxï¼‰ï¼š**

```tsx
// page.tsx â€” Server Componentï¼ˆä¸åŠ  'use client'ï¼‰
import { getAllProjects } from '@/data/projects';
import ProjectsClient from './ProjectsClient';

export const metadata = {
  title: 'Projects - Any Concept',
};

export default async function ProjectsPage() {
  const projects = await getAllProjects();
  return <ProjectsClient projects={projects} />;
}
```

```tsx
// ProjectsClient.tsx â€” Client Component
'use client';

export default function ProjectsClient({ projects }: { projects: Project[] }) {
  // äº¤äº’é€»è¾‘ã€åŠ¨ç”»ç­‰
}
```

**å½±å“ï¼š** è¿™æ˜¯é¡¹ç›®æœ€å¤§çš„æ¶æ„æ”¹è¿›æœºä¼šï¼Œèƒ½åŒæ—¶è§£å†³ SEOã€é¦–å±æ€§èƒ½å’Œç€‘å¸ƒæµé—®é¢˜ã€‚

---

## MEDIUM-HIGHï¼šå®¢æˆ·ç«¯æ•°æ®è·å–

### 22. localStorage è¯»å–ç¼ºå°‘ Schema ç‰ˆæœ¬æ§åˆ¶ `client-localstorage-schema`

**æ–‡ä»¶ï¼š** `src/hooks/useSafeLocaleStorage.ts:14`

**é—®é¢˜ï¼š** ç›´æ¥ä½¿ç”¨ `localStorage.getItem('locale')`ï¼Œç¼ºå°‘ schema ç‰ˆæœ¬æ§åˆ¶ã€‚å¦‚æœæœªæ¥æ•°æ®æ ¼å¼å˜æ›´ï¼Œæ—§æ•°æ®å¯èƒ½å¯¼è‡´å¼‚å¸¸ã€‚

**å»ºè®®ï¼š** ä½¿ç”¨ç‰ˆæœ¬åŒ– keyï¼š

```tsx
const LOCALE_KEY = 'locale_v1';
```

---

### 23. ç¿»è¯‘å‡½æ•° `t()` æ¯æ¬¡è°ƒç”¨éƒ½éå†å¯¹è±¡

**æ–‡ä»¶ï¼š** `src/hooks/useLanguage.tsx:27-42`

**é—®é¢˜ï¼š** `t()` å‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨æ—¶éƒ½æ‰§è¡Œ `key.split('.')` å’Œå¾ªç¯éå†ã€‚`t()` åœ¨æ¯ä¸ªç»„ä»¶çš„æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œè¿™äº›è®¡ç®—æ˜¯é‡å¤çš„ã€‚

**å»ºè®®ï¼š** é¢„è®¡ç®—æ‰å¹³åŒ–ç¿»è¯‘ Mapï¼š

```tsx
const flattenLocale = (obj: any, prefix = ''): Map<string, string> => {
  const map = new Map<string, string>();
  for (const [key, value] of Object.entries(obj)) {
    const path = prefix ? `${prefix}.${key}` : key;
    if (typeof value === 'object' && value !== null) {
      for (const [k, v] of flattenLocale(value, path)) {
        map.set(k, v);
      }
    } else {
      map.set(path, String(value));
    }
  }
  return map;
};

// åœ¨ Provider ä¸­ç”¨ useMemo ç¼“å­˜
const translations = useMemo(() => flattenLocale(locales[locale]), [locale]);

const t = useCallback((key: string): string => {
  return translations.get(key) ?? key;
}, [translations]);
```

**å½±å“ï¼š** ç¿»è¯‘æŸ¥æ‰¾ä» O(depth) é™ä¸º O(1)ã€‚

---

## MEDIUMï¼šé‡æ¸²æŸ“ä¼˜åŒ–

### 24. `isComplete` çŠ¶æ€é€šè¿‡ Effect æ´¾ç”Ÿ `rerender-derived-state-no-effect`

**æ–‡ä»¶ï¼š** `src/components/InteractiveText.tsx:254-259`

**é—®é¢˜ï¼š** `isComplete` æ˜¯ä» `clickCount` å’Œ `totalInteractiveItems` æ´¾ç”Ÿçš„å¸ƒå°”å€¼ï¼Œä½†ä½¿ç”¨ useEffect è€Œéç›´æ¥è®¡ç®—ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
const [isComplete, setIsComplete] = useState<boolean>(false);

useEffect(() => {
  if (totalInteractiveItems > 0 && clickCount >= totalInteractiveItems && !isComplete) {
    setIsComplete(true);
  }
}, [clickCount, totalInteractiveItems, isComplete]);
```

**å»ºè®®ä¿®æ”¹ï¼š** æ¸²æŸ“æ—¶ç›´æ¥è®¡ç®—ï¼š

```tsx
const isComplete = totalInteractiveItems > 0 && clickCount >= totalInteractiveItems;
```

**å½±å“ï¼š** å‡å°‘ä¸€æ¬¡ä¸å¿…è¦çš„é‡æ¸²æŸ“ã€‚

---

### 25. `onComplete` å›è°ƒå¯¼è‡´ Effect é‡æ‰§è¡Œ `rerender-dependencies`

**æ–‡ä»¶ï¼š** `src/components/TypewriterText.tsx:126`

**é—®é¢˜ï¼š** useEffect ä¾èµ–æ•°ç»„åŒ…å« `onComplete`ï¼Œå¦‚æœçˆ¶ç»„ä»¶æœªç”¨ `useCallback` åŒ…è£¹æ­¤å›è°ƒï¼Œæ¯æ¬¡çˆ¶ç»„ä»¶æ¸²æŸ“éƒ½ä¼šå¯¼è‡´æ‰“å­—æ•ˆæœé‡æ–°å¼€å§‹ã€‚

**å»ºè®®ä¿®æ”¹ï¼š** ä½¿ç”¨ ref å­˜å‚¨å›è°ƒï¼Œç§»å‡ºä¾èµ–ï¼š

```tsx
const onCompleteRef = useRef(onComplete);
onCompleteRef.current = onComplete;

useEffect(() => {
  // æ‰“å­—æ•ˆæœé€»è¾‘...
  // ä½¿ç”¨ onCompleteRef.current() ä»£æ›¿ onComplete()
}, [text, isVisible, delay, isInteractive]); // ç§»é™¤ onComplete
```

---

### 26. LanguageContext value æ¯æ¬¡æ¸²æŸ“é‡å»º `rerender-memo-with-default-value`

**æ–‡ä»¶ï¼š** `src/hooks/useLanguage.tsx:44-46`

**é—®é¢˜ï¼š** Provider çš„ `value` å¯¹è±¡ `{ locale, setLocale, t, isClient }` åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šåˆ›å»ºæ–°å¼•ç”¨ï¼Œå¯¼è‡´æ‰€æœ‰æ¶ˆè´¹è€…é‡æ¸²æŸ“ã€‚

**å»ºè®®ä¿®æ”¹ï¼š**

```tsx
const contextValue = useMemo(
  () => ({ locale, setLocale, t, isClient }),
  [locale, setLocale, t, isClient]
);

return (
  <LanguageContext.Provider value={contextValue}>
    {children}
  </LanguageContext.Provider>
);
```

---

### 27. ProjectItem åŠ¨ç”»ä¸­çš„ setInterval ä¸å¯ä¸­æ–­ä¸”å­˜åœ¨å†…å­˜æ³„æ¼

**æ–‡ä»¶ï¼š** `src/app/projects/ProjectItem.tsx:82-162`

**é—®é¢˜ï¼š** `animateText()` å‡½æ•°åˆ›å»ºå¤šä¸ª `setInterval`ï¼Œä½†è¯­è¨€åˆ‡æ¢æ—¶ï¼ˆç¬¬ 66-79 è¡Œçš„ useEffectï¼‰è¿™äº› interval æœªè¢«æ¸…ç†ã€‚æ–° interval ä¸æ—§ interval å¯èƒ½é‡å æ‰§è¡Œã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
useEffect(() => {
  setAnimationComplete(false);
  // ... é‡ç½®çŠ¶æ€
  const timer = setTimeout(() => {
    setOpacity(1);
    animateText(); // åˆ›å»ºæ–°çš„ intervalï¼Œä½†æ—§çš„æœªæ¸…ç†
  }, 100);
  return () => clearTimeout(timer); // åªæ¸…ç†äº† timeoutï¼Œæ²¡æ¸…ç† interval
}, [locale, title, description, year]);
```

**å»ºè®®ä¿®æ”¹ï¼š** ä½¿ç”¨ ref è¿½è¸ªæ‰€æœ‰ interval å¹¶åœ¨æ¸…ç†æ—¶ç»Ÿä¸€å–æ¶ˆï¼š

```tsx
const intervalsRef = useRef<NodeJS.Timeout[]>([]);

const clearAllIntervals = () => {
  intervalsRef.current.forEach(clearInterval);
  intervalsRef.current = [];
};

useEffect(() => {
  clearAllIntervals();
  // ... åŠ¨ç”»é€»è¾‘ï¼ŒæŠŠåˆ›å»ºçš„ interval å­˜å…¥ intervalsRef.current
  return clearAllIntervals;
}, [locale, title, description, year]);
```

---

## MEDIUMï¼šæ¸²æŸ“æ€§èƒ½

### 28. æ¡ä»¶æ¸²æŸ“ä½¿ç”¨ `&&` å¯èƒ½è¿”å›å‡å€¼ `rendering-conditional-render`

**æ–‡ä»¶ï¼š** å¤šå¤„

| æ–‡ä»¶ | è¡Œå· | ä»£ç  |
|------|------|------|
| `page.tsx` | 17 | `{isClient && introData && (...)}` |
| `InteractiveText.tsx` | 501 | `{isComplete && " ğŸ‰"}` |
| `ProjectItem.tsx` | 202 | `{(displayWIP \|\| animationComplete) && isWIP && ...}` |

**é£é™©ï¼š** å½“æ¡ä»¶å€¼ä¸º `0`ã€`""` æˆ– `NaN` æ—¶ï¼Œ`&&` ä¼šæ¸²æŸ“è¿™äº›å‡å€¼ã€‚ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼æ›´å®‰å…¨ã€‚

**å»ºè®®ï¼š**

```tsx
// å½“å‰
{isClient && introData && (<InteractiveText data={introData} />)}

// å»ºè®®
{isClient && introData ? <InteractiveText data={introData as ContentItem} /> : null}
```

---

### 29. åŠ è½½çŠ¶æ€é—ªçƒ `rendering-hydration-no-flicker`

**æ–‡ä»¶ï¼š** æ‰€æœ‰ä½¿ç”¨ `isClient` æ£€æŸ¥çš„é¡µé¢

**é—®é¢˜ï¼š** æœåŠ¡ç«¯æ¸²æŸ“ â†’ ç©ºç™½ â†’ å®¢æˆ·ç«¯æ°´åˆ â†’ æ˜¾ç¤ºå†…å®¹ï¼Œé€ æˆé¡µé¢é—ªçƒã€‚

**å»ºè®®ï¼š** å¦‚æœçŸ­æœŸå†…æ— æ³•è¿ç§»åˆ° RSC æ¶æ„ï¼ˆè§ #21ï¼‰ï¼Œå¯ä½¿ç”¨å†…è”è„šæœ¬æå‰è®¾ç½®è¯­è¨€ï¼š

```tsx
// layout.tsx çš„ <head> ä¸­
<script dangerouslySetInnerHTML={{ __html: `
  try {
    var l = localStorage.getItem('locale');
    if (!l) {
      l = navigator.language.startsWith('zh') ? 'zh' : 'en';
    }
    document.documentElement.lang = l === 'zh' ? 'zh-CN' : 'en';
    document.documentElement.dataset.locale = l;
  } catch(e) {}
`}} />
```

ç„¶åç»„ä»¶å¯ä»¥è¯»å– `document.documentElement.dataset.locale` ä½œä¸ºåˆå§‹å€¼ï¼Œé¿å… `isClient` äºŒæ¬¡æ¸²æŸ“ã€‚

---

### 30. ä½œå“åˆ—è¡¨å¯ä½¿ç”¨ CSS `content-visibility` ä¼˜åŒ– `rendering-content-visibility`

**æ–‡ä»¶ï¼š** `src/app/craft/page.tsx:37`

**é—®é¢˜ï¼š** Craft é¡µé¢ä½¿ç”¨ç€‘å¸ƒæµå±•ç¤ºä½œå“ï¼Œå¦‚æœä½œå“æ•°é‡å¢å¤šï¼ˆ>50ï¼‰ï¼Œæ‰€æœ‰å¡ç‰‡éƒ½ä¼šåŒæ—¶æ¸²æŸ“ã€‚

**å»ºè®®ï¼š** å½“å‰æ•°æ®é‡å¯èƒ½è¾ƒå°ï¼Œæš‚ä¸ç´§æ€¥ï¼Œä½†å¯ä»¥å…ˆæ·»åŠ  CSS ä¼˜åŒ–ï¼š

```css
.break-inside-avoid {
  content-visibility: auto;
  contain-intrinsic-size: auto 300px;
}
```

---

## LOW-MEDIUMï¼šJavaScript æ€§èƒ½

### 31. æ­£åˆ™è¡¨è¾¾å¼åœ¨å‡½æ•°å†…åå¤åˆ›å»º `js-hoist-regexp`

**æ–‡ä»¶ï¼š** `src/components/InteractiveText.tsx:75, 79`

**é—®é¢˜ï¼š** `tokenizeText()` åœ¨æ¯æ¬¡è°ƒç”¨æ—¶éƒ½åˆ›å»ºä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
const tokenizeText = (text: string): string[] => {
  const containsNonASCII = /[^\u0000-\u00ff]/.test(text);
  // ...
  const regex = /([^\s\p{P}]+)|(\p{P}+)|\s+/gu;
};
```

**å»ºè®®ä¿®æ”¹ï¼š** æå‡åˆ°æ¨¡å—é¡¶å±‚ï¼š

```tsx
const NON_ASCII_RE = /[^\u0000-\u00ff]/;
const CJK_TOKEN_RE = /([^\s\p{P}]+)|(\p{P}+)|\s+/gu;

const tokenizeText = (text: string): string[] => {
  const containsNonASCII = NON_ASCII_RE.test(text);
  // ...
  // æ³¨æ„ï¼šå¸¦ /g æ ‡å¿—çš„æ­£åˆ™éœ€è¦é‡ç½® lastIndex
  CJK_TOKEN_RE.lastIndex = 0;
  // ...
};
```

**åŒæ ·é—®é¢˜ï¼š** `TypewriterText.tsx:162` ä¸­çš„ `/\/([^\/]+)\.[^\.]+$/`ã€‚

---

### 32. ProjectItem åŠ¨ç”»ä¸­çš„å­—ç¬¦ä¸²æ‹¼æ¥å¯ä¼˜åŒ– `js-combine-iterations`

**æ–‡ä»¶ï¼š** `src/app/projects/ProjectItem.tsx:93-100`

**é—®é¢˜ï¼š** æ¯ä¸ª interval tick éƒ½è¿›è¡Œ `substring` + å¾ªç¯ç”Ÿæˆéšæœºå­—ç¬¦ + å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ¯ç§’æ‰§è¡Œçº¦ 20 æ¬¡ã€‚

**å½“å‰ä»£ç ï¼š**

```tsx
let randomChars = '';
for (let i = 0; i < Math.min(5, title.length - currentLength); i++) {
  randomChars += getRandomChar();
}
setDisplayTitle(title.substring(0, currentLength) + randomChars);
```

**å»ºè®®ä¿®æ”¹ï¼š** é¢„ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ç¼“å­˜ï¼š

```tsx
const RANDOM_CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
const pregenerated = Array.from(
  { length: 20 },
  () => RANDOM_CHARS[Math.floor(Math.random() * RANDOM_CHARS.length)]
).join('');

// ä½¿ç”¨æ—¶ç›´æ¥ slice
setDisplayTitle(
  title.substring(0, currentLength) +
  pregenerated.slice(0, Math.min(5, title.length - currentLength))
);
```

---

## å®æ–½è·¯çº¿å›¾

## ç¬¬ä¸€é˜¶æ®µï¼šä½æˆæœ¬é«˜æ”¶ç›Š

ä¸æ”¹å˜æ¶æ„ï¼Œå¿«é€Ÿä¿®å¤å³å¯è·å¾—æ˜¾è‘—æå‡ã€‚

| ç¼–å· | ç±»å‹ | å†…å®¹ | æ”¶ç›Š |
|------|------|------|------|
| #1 | ç•Œé¢è§„èŒƒ | NavButton `<div>` â†’ `<button>` | æ— éšœç¢æ ¸å¿ƒä¿®å¤ |
| #2 | ç•Œé¢è§„èŒƒ | äº¤äº’æ–‡æœ¬æ·»åŠ é”®ç›˜æ”¯æŒ | æ— éšœç¢æ ¸å¿ƒä¿®å¤ |
| #3 | ç•Œé¢è§„èŒƒ | è¡¥å…… focus-visible ç„¦ç‚¹æ ·å¼ | é”®ç›˜å¯ç”¨æ€§ |
| #4 | ç•Œé¢è§„èŒƒ | è¯­è¨€åˆ‡æ¢æŒ‰é’® aria-label | æ— éšœç¢ |
| #8 | ç•Œé¢è§„èŒƒ | SVG æ·»åŠ  aria-hidden | æ— éšœç¢ |
| #15 | æ€§èƒ½ | è¯¦æƒ…é¡µ Promise.all å¹¶è¡Œè¯·æ±‚ | åŠ è½½æ—¶é—´å‡åŠ |
| #17 | æ€§èƒ½ | NavButton åŠ¨æ€åŠ è½½ | é¦–å± JS å‡å°‘ ~40KB |
| #24 | æ€§èƒ½ | isComplete ç›´æ¥è®¡ç®— | å‡å°‘ä¸å¿…è¦æ¸²æŸ“ |
| #26 | æ€§èƒ½ | Context value useMemo | å‡å°‘å…¨å±€é‡æ¸²æŸ“ |
| #27 | æ€§èƒ½ | æ¸…ç† interval æ³„æ¼ | ä¿®å¤å†…å­˜æ³„æ¼ |

## ç¬¬äºŒé˜¶æ®µï¼šä¸­ç­‰æŠ•å…¥

å±€éƒ¨æ¶æ„è°ƒæ•´ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

| ç¼–å· | ç±»å‹ | å†…å®¹ | æ”¶ç›Š |
|------|------|------|------|
| #5 | ç•Œé¢è§„èŒƒ | åˆ—è¡¨é¡µæ·»åŠ  `<h1>` | é¡µé¢ç»“æ„ |
| #7 | ç•Œé¢è§„èŒƒ | å…¨å±€ prefers-reduced-motion | åŠ¨ç”»æ— éšœç¢ |
| #11 | ç•Œé¢è§„èŒƒ | DOM æ“ä½œæ”¹ç”¨ useRef | ä»£ç è´¨é‡ |
| #19 | æ€§èƒ½ | æ•°æ®æŒ‰è¯­è¨€åŠ¨æ€åŠ è½½ | Bundle å‡å°‘ |
| #23 | æ€§èƒ½ | æ‰å¹³åŒ–ç¿»è¯‘ Map | ç¿»è¯‘æŸ¥æ‰¾ O(1) |
| #25 | æ€§èƒ½ | onComplete ç”¨ ref å­˜å‚¨ | ä¿®å¤æ½œåœ¨ bug |
| #29 | æ€§èƒ½ | å†…è”è„šæœ¬æ¶ˆé™¤é—ªçƒ | é¦–å±ä½“éªŒ |
| #31 | æ€§èƒ½ | æ­£åˆ™æå‡åˆ°æ¨¡å—é¡¶å±‚ | GC å‹åŠ› |

## ç¬¬ä¸‰é˜¶æ®µï¼šæ¶æ„çº§æ”¹è¿›

éœ€è¦è¾ƒå¤§é‡æ„ï¼Œä½†æ”¶ç›Šæœ€ä¸ºæ˜¾è‘—ã€‚

| ç¼–å· | ç±»å‹ | å†…å®¹ | æ”¶ç›Š |
|------|------|------|------|
| #12 | ç•Œé¢è§„èŒƒ | layout.tsx ä¼˜åŒ–ï¼ˆtheme-colorã€skip linkï¼‰ | SEO å’Œæ— éšœç¢ |
| #13 | ç•Œé¢è§„èŒƒ | é¢åŒ…å±‘è¯­ä¹‰åŒ– | ç»“æ„åŒ–æ•°æ® |
| #20 | æ€§èƒ½ | Cookie å­˜å‚¨è¯­è¨€åå¥½ | æ¶ˆé™¤æ°´åˆé—ªçƒ |
| #21 | æ€§èƒ½ | è¿ç§»åˆ° RSC æ¶æ„ | SEO + é¦–å±æ€§èƒ½è´¨å˜ |
| #18 | æ€§èƒ½ | åˆ†æå¹¶ä¼˜åŒ– framer-motion å æ¯” | æŒ‰åˆ†æç»“æœå†³å®š |
